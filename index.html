<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Bitcoin Price</title>
    <style type="text/css">
      body {
        background-color: #000;
        color: #fff;
        padding: 5vh;
        overflow: hidden;
        font-size: 14pt;
        line-height: 1.0em;
      }
      h1 {
        color: #e4e39f;
        margin: 0;
        padding: 0 5vh;
        font-size: 80vh;
        line-height: 1.0em;
        -webkit-user-select: none;
        text-align: center;
        font-family: 'Consolas','Monaco','Courier New', monospace;
        font-weight: normal;
      }
    </style>
  </head>
  <body>
    <h1>$<span id="price">&mdash;.&mdash;</span></h1>
    <script src="https://d3dy5gmtp8yhk7.cloudfront.net/2.1/pusher.min.js" type="text/javascript"></script>
    <script>
      const socket = new Pusher('de504dc5763aeef9ff52')
      const channel = socket.subscribe('live_trades')
      let lastPrice = 0
      channel.bind('trade', handleTrade)

      function handleTrade(trade) {
        const price = parseFloat(trade.price)
        const el = document.getElementById('price')
        el.innerHTML = price.toFixed(2)
        const c0 = '#e4e39f'
        const h1 = document.getElementsByTagName('h1')[0]
        if(price > lastPrice) {
          // Color UP
          delayColor(h1, '#06ca17', c0, 2500)
        } else if(price < lastPrice) {
          // Color DOWN
          delayColor(h1, '#ca1a06', c0, 2500)
        }
        lastPrice = price
      }

      let cid = -1
      function delayColor(el,ci,cf,delay) {
        el.style.color = ci
        window.clearTimeout(cid)
        cid = window.setTimeout(() => {
          el.style.color = cf
        }, delay)
      }
    </script>
  </body>
</html>